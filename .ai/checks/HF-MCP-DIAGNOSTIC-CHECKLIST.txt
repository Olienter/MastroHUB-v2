# HF-MCP-DIAGNOSTIC-CHECKLIST: Systematické riešenie MCP integrácie

## PROBLÉM
MCP tools fungujú pri `listTools()`, ale Cursor UI stále ukazuje červenú bodku a terminál čaká na Enter.

## DIAGNOSTICKÝ CHECKLIST PRE V1 TALK

### 1. ZÁKLADNÁ DIAGNÓZA (5 min)
```bash
# Over základné prostredie
cd /c/Users/olieb/Mastro
node --version
pnpm --version
git rev-parse HEAD
date -u
```

**Čo hľadať:** Node verzia, PNPM verzia, aktuálny commit, timestamp

### 2. MCP SERVER BUILD OVERVIEW (10 min)
```bash
cd tools/mcp-ai-evidence
pnpm run build
ls -la dist/
wc -l dist/server.js
sha256sum dist/server.js
stat dist/server.js
```

**Čo hľadať:** 
- Build úspešný?
- `dist/server.js` existuje a má správnu veľkosť?
- Posledná modifikácia súboru

### 3. MCP SERVER MANUÁLNY TEST (15 min)
```bash
# Terminal 1: Spusti MCP server
cd tools/mcp-ai-evidence
node dist/server.js

# Terminal 2: Test MCP komunikácie
# (Tu budeš potrebovať MCP klienta na testovanie)
```

**Čo hľadať:**
- Server sa spustí bez chýb?
- "MCP server ready (stdio)" sa zobrazí?
- Server nevisí a čaká na input?

### 4. CURSOR MCP KONFIGURÁCIA OVERVIEW (5 min)
```bash
# Over aktuálnu konfiguráciu
cat .cursor/mcp.json
cat tools/mcp-ai-evidence/package.json | grep -A 10 '"scripts"'
```

**Čo hľadať:**
- `cwd` je správne nastavené na `tools/mcp-ai-evidence`
- `command` je `node` (nie `pnpm`)
- `args` je `["dist/server.js"]`

### 5. MCP SERVER HEALTH CHECK (10 min)
```bash
# Test health_check tool
cd tools/mcp-ai-evidence
node -e "
const { spawn } = require('child_process');
const server = spawn('node', ['dist/server.js'], { stdio: ['pipe', 'pipe', 'pipe'] });

// Počkaj na 'MCP server ready'
server.stdout.on('data', (data) => {
  console.log('Server output:', data.toString());
  if (data.toString().includes('MCP server ready')) {
    console.log('✓ Server je pripravený');
    server.kill();
  }
});

server.stderr.on('data', (data) => {
  console.log('Server error:', data.toString());
});

setTimeout(() => {
  console.log('✗ Timeout - server sa nespustil');
  server.kill();
}, 5000);
"
```

**Čo hľadať:**
- Server sa spustí a zobrazí "MCP server ready"
- Žiadne chyby v stderr
- Server sa ukončí správne

### 6. CURSOR RESTART A MCP RELOAD (10 min)
```bash
# 1. Zatvor Cursor úplne
# 2. Spusti Cursor znovu
# 3. Počkaj na MCP server inicializáciu
# 4. Skontroluj Tools panel
```

**Čo hľadať:**
- Červená vs zelená bodka v Tools paneli
- Správa "No tools or prompts" vs dostupné nástroje
- Či sa MCP server pripojil

### 7. MCP TOOL REGISTRATION TEST (15 min)
```bash
# Ak máš prístup k MCP klientovi, test:
# 1. listTools() - malo by vrátiť 3 nástroje
# 2. create_evidence invoke
# 3. health_check invoke
```

**Čo hľadať:**
- `listTools()` vráti správne nástroje
- `create_evidence` vytvorí súbor
- `health_check` vráti server info

### 8. WINDOWS ŠPECIFICKÉ PROBLÉMY (10 min)
```bash
# Over Windows path handling
cd tools/mcp-ai-evidence
pwd
echo $PWD
node -e "console.log('CWD:', process.cwd())"
node -e "console.log('__dirname:', __dirname)"
```

**Čo hľadať:**
- Cesty sa správne resolvujú
- `process.cwd()` je správny
- `__dirname` ukazuje správny priečinok

### 9. ENVIRONMENT VARIABLES A PERMISSIONS (5 min)
```bash
# Over prostredie
cd tools/mcp-ai-evidence
echo $NODE_ENV
echo $PATH
ls -la dist/server.js
```

**Čo hľadať:**
- `dist/server.js` má správne permissions
- `NODE_ENV` je nastavené (ak potrebné)
- `PATH` obsahuje Node.js

### 10. ALTERNATÍVNE KONFIGURÁCIE (15 min)
```bash
# Test rôznych konfigurácií v .cursor/mcp.json

# Variant 1: Absolútne cesty
# "cwd": "C:\\Users\\olieb\\Mastro\\tools\\mcp-ai-evidence"

# Variant 2: PNPM script
# "command": "pnpm",
# "args": ["run", "cursor:mcp"]

# Variant 3: Node s full path
# "command": "node",
# "args": ["C:\\Users\\olieb\\Mastro\\tools\\mcp-ai-evidence\\dist\\server.js"],
# "cwd": "."
```

**Čo hľadať:**
- Ktorá konfigurácia funguje
- Ktorá dáva zelenú bodku
- Ktorá nevyžaduje Enter v termináli

## EVIDENCE TEMPLATE

Po každom kroku zapíš do `.ai/checks/HF-MCP-DIAGNOSTIC-RESULTS.txt`:

```json
{
  "step": "1_ZAKLADNA_DIAGNOZA",
  "timestamp": "2025-01-27T00:00:00.000Z",
  "command": "node --version",
  "output": "v18.17.0",
  "status": "SUCCESS/FAIL/ERROR",
  "notes": "Node verzia je aktuálna"
}
```

## KRITICKÉ OTÁZKY PRE V1 TALK

1. **Či sa MCP server spustí manuálne** bez chýb?
2. **Či Cursor vidí MCP server** po reštarte?
3. **Či sa UI zmení** z červenej na zelenú bodku?
4. **Či terminál automaticky pokračuje** bez Enter?
5. **Ktorá konfigurácia funguje** najlepšie?

## ĎALŠIE KROKY

Ak diagnostika neprinesie jasný výsledok:
- **HARDEN card** pre UI layer debugging
- **TRANSPORT card** pre MCP komunikáciu
- **CURSOR INTEGRATION card** pre deep dive

---

**PRIORITA:** Začni s krokom 1-3, potom 6 (Cursor restart), potom 7 (tool test).
